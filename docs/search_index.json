[
["index.html", "Sleep quality analysis Chapter 1 Prerequisites", " Sleep quality analysis Arturo Laflor 2017-04-27 Chapter 1 Prerequisites This is a sample book written in Markdown. You can use anything that Pandoc’s Markdown supports, e.g., a math equation \\(a^2 + b^2 = c^2\\). For now, you have to install the development versions of bookdown from Github: devtools::install_github(&quot;rstudio/bookdown&quot;) Remember each Rmd file contains one and only one chapter, and a chapter is defined by the first-level heading #. To compile this example to PDF, you need to install XeLaTeX. "],
["intro.html", "Chapter 2 Introduction", " Chapter 2 Introduction You can label chapter and section titles using {#label} after them, e.g., we can reference Chapter 2. If you do not manually label them, there will be automatic labels anyway, e.g., Chapter 5. Figures and tables with captions will be placed in figure and table environments, respectively. par(mar = c(4, 4, .1, .1)) plot(pressure, type = &#39;b&#39;, pch = 19) Figure 2.1: Here is a nice figure! Reference a figure by its code chunk label with the fig: prefix, e.g., see Figure 2.1. Similarly, you can reference tables generated from knitr::kable(), e.g., see Table 2.1. knitr::kable( head(iris, 20), caption = &#39;Here is a nice table!&#39;, booktabs = TRUE ) Table 2.1: Here is a nice table! Sepal.Length Sepal.Width Petal.Length Petal.Width Species 5.1 3.5 1.4 0.2 setosa 4.9 3.0 1.4 0.2 setosa 4.7 3.2 1.3 0.2 setosa 4.6 3.1 1.5 0.2 setosa 5.0 3.6 1.4 0.2 setosa 5.4 3.9 1.7 0.4 setosa 4.6 3.4 1.4 0.3 setosa 5.0 3.4 1.5 0.2 setosa 4.4 2.9 1.4 0.2 setosa 4.9 3.1 1.5 0.1 setosa 5.4 3.7 1.5 0.2 setosa 4.8 3.4 1.6 0.2 setosa 4.8 3.0 1.4 0.1 setosa 4.3 3.0 1.1 0.1 setosa 5.8 4.0 1.2 0.2 setosa 5.7 4.4 1.5 0.4 setosa 5.4 3.9 1.3 0.4 setosa 5.1 3.5 1.4 0.3 setosa 5.7 3.8 1.7 0.3 setosa 5.1 3.8 1.5 0.3 setosa You can write citations, too. For example, we are using the bookdown package (Xie 2016) in this sample book, which was built on top of R Markdown and knitr (Xie 2015). This is an other form of reference a markdown table in R book down&gt; Table 2.2: Demographic features in dataset Feature Count Miss Card Mode MF MP Mode2 M2F M2P 338 0 2 Femenino 188 55.62% Masculino 150 44.38% 338 1 5 Docente 143 42.31% Empleado 70 20.71% 338 0 4 Más mental 156 46.15% Mental 143 42.31% que físico DD4 338 2 5 ASD 150 44.38% Católica 129 38.17% 338 0 5 Casada(o) 181 53.55% Soltera(o) 119 35.21% 338 0 5 Ninguno 284 84.02% Otro 26 7.69% 338 1 5 No 272 80.47% Otra 34 10.06% The table 2.2 shows the demographic features for the dataset that will be analyzed References "],
["data-adquisition.html", "Chapter 3 Data adquisition 3.1 Questionnaire 3.2 Validity and reliability 3.3 Dataset", " Chapter 3 Data adquisition 3.1 Questionnaire In order to obtain data that contribute with evidence, regarding of relations between Sleep Hygiene Factors (FSH) and the Quality of Sleep (QS), we selected two questionnaires clinically used. The Sleep Hygiene Index (SHI) and the Pitsburgh Sleep Quality Index (PSQI). As the population where the new questionnaire would be applied is Spanish-speaking and original questionnaires are in English language, we proceed to do the process of translation. The valid process to obtain a reliable translation consist of following stages: A person A translate the questionnaires from English to Spanish, a person B getback the spanish translation to the English language, and, a person C, compare the questionnaire obtained by the translation of the B person agains the original questionnaire. The C person, writes comments regarding of those itemes that do not match in meaning, corrections are done, and the process iterate until reach a satisfactory result (see Fig. 3.1). Figure 3.1: Double translation After this translation, the two questionnaires where joined in a single questionnaire, adding a section in order to obtain demographic, emoptional and health data of relevance to this study. The new questionnaire was comformed by three sections. The first section has six demographic items, one emotional and one health item, the second section is the PSQI questionnaire that consists of 20 items, and, the third section is the SHI whit a total of 21 items. In the end, the SHI survey was left with 21 items, unlike the original that has 13, this has been, only for data granularity reasons, however, the changes do not alter the SHI objective. For example, item six of the original questionnaire that asked about the use of tobacco, alcohol, or caffeine, became three items to ask separately about the use of these three substances. In the end, the questionnaire consisted of 47 items, divided into three sections that are described later. The purpose of the questionnaire is to collect data to be analyzed using automated learning techniques (specifically the techniques of feature selection) to determine those sleep hygiene factors that have a greater impact on the quality of sleep from the respondent’s perception. One of the specific objectives of this research is to delimit the domain of input data to a subset of factors that explain an appropriate percentage of the variance of the phenomenon. The resulting factors will be used as the predictive variables in the first stage of training of the inference model to estimate the quality of sleep. 3.1.1 Demographic emotional and health data 3.1.1.1 Demographic In this section we ask about six relevant data that allow to understand the context of respondent. The six variables are age, gender, ocupation, kind of work, religion and civil status. Of this six variables, kind of work provide relevant information to the study, since the literature says that phisical activity improve the sleep quality [cita] . The options for this question are: intellectual, phisical, more intellectual than phisical and, more phisical than intellectual. The other variables in this section are for exploration purposes regarding of sleep quality and sleep hygiene. 3.1.1.2 Emotional This variable asks to the respondent if he/she are in a crisis time. The crisis can be financial, mourning, divorce, or other that can significantly alter the quality of sleep. This answer is a target population filter for this study. Data from people in this circumstances are noisy to the study and should not be part of the data that will be used for the analysis. 3.1.1.3 Health Similar than Emotional variable, the health variable asks if the respondent suffers from a chronic degenerative disease such as diabetes, hypertension, depression or another that can directly or indirectly alter the quality of sleep. Data from people suffering some disease are removed before the analysis. 3.1.2 Quality of Sleep The PSQI is considered the gold standard questionnaire to evaluate subjective sleep quality (Brick, Seely, and Palermo 2010), and has been used to estimate the quality of sleep in clinical and nonclinical population (Mastin, Bryson, and Corwyn 2006), and has been referred by numerous researchs in diverse sleep assessments (Bai et al. 2012). This questionnaire evaluates the quality of sleep using nineteen items grouped in seven components: subjective sleep quality, sleep duration, sleep latency, sleep disturbances, use of sleep medication, day time disfunction and sleep latency. The questionnaire provide a baremo to score each component and sumarize the final score resulting in a dicotomic varaible; -good quality of sleep- or -poor quality of sleep- (Buysse et al. 1989). For the purposes of this study, eighteen of the nineteen items was used in the second section, it fact does not affect the score results, since that latter item is not taken into account for the computation of the scale in the original questionnaire. On the other hand, the last item has to do with specific sleep disorders, for example, -sleep apnea-, while this study seeks to understand sleep habits in healthy people. 3.1.3 Sleep Hygiene Index It is an instrument designed to measure the sleep hygiene behavior in a nonclinical population. Its theoretical basis is in the criteria that International Classification of Sleep Disorders (ICSD) uses to diagnose an inadequate sleep hygiene. The scale has thirteen items and has reported an internal validity of \\(\\alpha=0.71\\), as well a high reliability in test-retest evaluation(Mastin, Bryson, and Corwyn 2006). For the purposes of this study and based on what the literature reports regarding sleep hygiene factors, the following adjustments were made to the instrument, without interfering with its essence: Following the structure and the meaning of the item four - I exercise to the point of sweating within 1 h of going to bed-, two items were added: - I exercise to the point of sweating during the morning- and -I exercise to the point of sweating during the afternoon.- . The main purpose was to know whether the exercise in the morning or in the afternoon is directly correlated with sleep quality.[cita] Item six of the original questionnaire that asked about the use of tobacco, alcohol, or caffeine, became three items to ask separately about the use of these three substances. Item 11 in the original questionnaire asks about an uncomfortable bedroom, due to four environment factors. In the questionnaire for this study, four items was generated from this one. Based on what the literature says about dinner type and schedule, and its negative impact on sleep quality, an item was added to the questionnaire (Posner and Gehrman 2011,Stefano2014,Irish et al. (2015),D. Wentz and Wentz (2011)). 3.2 Validity and reliability After the instrument was completed, it was validated by five experts that qualify each item on a escale of 1 to 5 for two metrics, clarity and pertinence. All items were qualified as clear and relevant. with the mean of 4.5 and 4.7 respectively. A sample of 30 people was randomly selected to perform the pilot test and obtain the internal validity of the instrument. Cronbach’s alpha for the instrument after pilot test was \\(\\alpha=0.68\\). This \\(\\alpha\\) value is acceptable and consistent with that reported by (Mastin, Bryson, and Corwyn 2006) for the SHI scale, with this we proceeded to apply the questionnaire to a wider population to collect the dataset with which the analyzes were made for the selection of Variables that will be taken into account for the construction of the model. 3.3 Dataset As a result of apply the questionnaire, a raw dataset \\((m=342, n=47)\\) was obtained, this dataset, have missing data, some columns are no significant in terms of variance, there exist data in a wrong format to analyze, among other data quality issues. To obtain the dataset to the feature selection analysis, it was neccesary a pre-process of data, what included: The data quality analysis, the data quality plan to attend the issues and the implementation of the data quality plan. After this pre-process of data, the final dataset is conformed by one ID, 51 continuous and 10 categorical features grouped as shows the table ??. The complete description of the dataset is in the tables ??, ??, ??, ?? and ??. At the end, the dataset contains 21 columns of main predictive variables (SHI), one column for continuous target variable (SQTT), and, one column for categorical target variable (SQCL). The other features in the dataset have diverse purposes as the last column of each table describes. References "],
["data-pre-process.html", "Chapter 4 Data pre-process 4.1 Estructuration and validation data process 4.2 Data quality report 4.3 Categorical Features for demographics data 4.4 Following the quality plan to attend issues 4.5 Imputation of missing values in SH and SQ features 4.6 Final results", " Chapter 4 Data pre-process 4.1 Estructuration and validation data process Before to generate the quality report of the data, the data are loaded and passed for a process of validation and restructuration. This process includes the renaming of the columns and data validation for columns containing information of time and age. Additionally, the values for the responses of SHI and PSQI questionnaires was recodified from original responses (‘Nunca’,‘Casi nunca’,‘Algunas veces’,‘Frecuentemente’,‘Siempre’) to data that can be used to numerical and algorithmical analysis (‘0’,‘1’,‘2’,‘3’,‘4’). The resulting dataset has 48 columns, distributed as the ?? shows: The quality analysis of data was based in the recommendations of (Kelleher, Namee, and D’Arcy 2015). The resulting dataset will allow runs the algorithms to select the relevant features to generate the model. The analysis of the data quality includes the treadment of missing values, outliers and cardinality as well as correction of some possible bugs in the scripts that do the process of restructuration and validation of the dataset. The data quality analysis begins with a report of quality of continouos and categorical features. For continuous variables ten metrics were analyzed: quantity, missing values, cardinality, minimum value, first quartile, median, third quartile, maximum value, mean, and standard deviation. For categorical variables, nine metrics were analyzed: quantity, missing values, cardinality, mode, mode frequency, mode percent, second mode, second mode frequency and second mode percent. Before to do this report, a look at the complete dataset allowed to identify three records that contains no data for any feature. These records were deleted to avoid noisy information in the quality analysis. 4.2 Data quality report The data quality report was performed using two scripts, one for continuous and one for categorical features, so, the features were grouped by type to do the analysis. 4.2.1 Continuous features The dataset contains five continuous features, one for demographic data (DD1=AGE) and four features that measure the sleep duration (SQ1=“Time to go to bed”, SQ2=“Latency of sleep”, SQ3=“Time to wake up”, SQ4=“Period of time between going to bed and waking up”). The table ?? shows some irregularities in continuous variables, as we can see, a negative value is the minimum value in the SQ4 variable; this variable represents the Period of time between going to bed and waking up, thus no negative value must be enter in this field, likewise, it appear a \\(0.0\\) value as the minimun value in the SQ1 variable, which is wrong because this is the time that respondents said go to bed, and, in this case, \\(0.00\\) is not a valid answer, in any case, an appropriate answer would be \\(12.00\\), referring to midnight. On the other hand, the variable SQ2, has a large standard deviation (\\(\\sigma=11.91\\)), since the variable represents the minutes that person takes to fall asleep in minutes (\\(\\mu\\simeq 15\\)). No one of these features have a great quantity of missing values, DD1 is the variable with most of them, however the missing values represents only the \\(0.018 \\%\\) of the data, whis is not significant. If we assume that each record that contains a missing value is a different row, we have \\(12\\) records, which represents the \\(0.036\\%\\). As this percentage is small, and there are not in our hands, previous works describing the tendency of the data, these records with missing values could be deleted. These continuos variables shows good cardinality, even though the ratio between the cardinality and number of records is not close to one. The nature of the data justifies this fact, because although the features are continuous and in theory they could take a large number of values, they take a small range of values, for instance, the variable SQ1 take an small range of values because the people answer commonly to this kind of question with onclock time, it means, people ask that they go to bed at \\(9:00\\), \\(10:30\\), \\(10:45\\) or \\(11:00\\), even when they, actually were to bed at \\(9:03\\), or \\(10:33\\) referring to the first to examples. The other variables have similar nature, thus the conclusion that cardinality is good for this variables, where the smallest cardinality was 15. Additionaly to previous analysis, histograms and boxplot were generated to observe the behaviour of the data. Figure 4.1: Histograms and boxplots of the continuous features The plots in the Fig. 4.1 shows that the continuous features have outliers which should be analyzed to include/exclude from de dataset before of the training of the model to obtain better results. These variables do not intervene directly in the generation of the model, the model is generated from the SH features, however, these outliers could be indicators of some disorder of sleep in the respondent, thus the analysis must be performed. The Table ?? summarizes the data quality issues in continuous features and the potential strategies to attend them. 4.3 Categorical Features for demographics data The categorical features were divided in two groups, the demographic features are in the first group and the features containing all the information over the sleep hygiene are in other group. The table ?? shows only one irregularity in this set of variables, the variable DD6 has the hihest mode posible (\\(100\\%\\)), if data are right, all respondents are living in free union status which is very doubtful taken in account the population were the questionnaire was applied. There are less missing values than in the continuous features, so, it is possible to think in eliminate the records. The cardinality is not a problem in this set of features (except for the variable DD6 as commented above), since all posibilities have representation. In the two cases (features DD7 and DD8) where the mode capture a high percentage of the data, the information is good for this research. DD7 refers to people who suffer some chronic disease, the best answer to this work is “Any” because the intention is to work with healthy people, likewise in the DD8 variable that ask to the people if they are in some crisis that disrups their sleep, the best answer to this work is “No”, fortunatelly, this is the mode. 4.3.1 Categorical features for Slepp hygiene In Table ??, the cardinality shows that all possible value \\([0-5]\\) for each answer is represented in the data, except by the SH9 variable where one of the options was not selected as answer of the respondents. It is good for the quality of data, however, there are two variables with high mode. The 81.66 % of the respondents, answered never (\\(0\\)) to the question SH9 “I use alcohol within 4 hours of going to bed or after going to bed.”, while the 94.38% answered never (\\(0\\)) to the question SH8 “I use tobacco within 4 hours of going to bed or after going to bed.”, which means that there are few variability in the data in these two variables. It is possible to dispense with these data for the analysis, since they do not contribute much information to the studied phenomenon for this population. The other 19 categorical variables for SHI, have a cardinality of 5, and the higher mode is placed in SH10 “I use cafeine within 4 hours of going to bed or after going to bed.” were a \\(66.98\\%\\) of the respondents answered never (\\(0\\)) for this question. This means that the answers have a good range of variability to be analized, and to participate as candidate of be selected as feature to training the model. This set of data has small number of missing values, however, in this case it is possible to impute data due to the features together represents a behavior of the person. Algorithms as KNN or a multiple logistic regression can performs data imputation to have a good approximation to the true data. The table ?? present the summary of the issues and potential strategies for the SH features. 4.4 Following the quality plan to attend issues The first step in order to attend the issues was the analysis of the code that validates the raw data, to avoid the suspicious of bugs that could be generate wrong data. After the code is validated, the errors in data can be adjudicate to human capture. After the analysis of scripts, tree bugs were fixed. The first bug is related with the reason that the civil status have a mode equivalent to the number of records in the dataset. The bug was generated by omittining a condition in the evaluation of a missing value in the field in the same line of code that attempt to standardize the results so that all the sentences were in the same style of case. In the case of status civil feature, some answers are wroten as ‘Unión libre’, while other was wroten as ‘Unión Libre’. The line with the bug: ifelse(is.na(dataSet$DD6),dataSet$DD6&lt;-NA,dataSet$DD6&lt;-&quot;Unión Libre&quot;) The line after being fixed: ifelse(is.na(dataSet$DD6),dataSet$DD6&lt;-NA,dataSet[dataSet$DD6=='Unión libre',7]&lt;-&quot;Unión Libre&quot;) The second bug was identified in the script that calculates the time of sleep depending of the three variables, ‘Time to go the bed’, ‘Time to wake up’, ‘Time to fall asleep’, in this case, the condition for the calculation does not contemplate that a person could say that he went to bed and got up twelve hours apart. The problem was solved by modifying the conditional operator of \\(&gt;\\) to \\(\\geq\\). Code with bug: if(HD&gt;HL){ HD&lt;-HD-12.00 } SE&lt;-abs(HL-HD) SE&lt;-SE-round(minutos/60,digits = 2) Code after being fixed: if(HD&gt;=HL){ HD&lt;-HD-12.00 } SE&lt;-abs(HL-HD) SE&lt;-SE-round(minutos/60,digits = 2) The third bug was corrected by adding two condition per values before ignored. Values in the range of \\((-\\infty,0)\\) must be taken a NA value, and values in the range of \\([0,1)\\) must be transformed by adding 12.00. The lines that were added are: if(!is.na(s3)){ if(as.numeric(s3)&lt;0){ s3&lt;-NA }else if(as.numeric(s3)&lt;1){ s3=as.numeric(s3)+12 }else{ s3&lt;-as.numeric(s3) } } The quality reports generated after apply this corrections, show a difference in the identified features with possible issues due to a wrong treatment. The minimum value in SQ1 is not zero as before, now it is one, which is reasonable; the variable SQ4 do not have a negative value as minimum value. The present also is very small (\\(0.12\\)) and was verified in the raw data, the conclusion is that it was a wrong user capture, the respondent said that he/she go to bed at 12:30 and wakes up at 12:42 every day. On the other hand, the civil status (DD6) has a congruent value for the sample of study, the \\(53.55\\%\\) of the respondents said be married and \\(35.21\\%\\) be single, in contrast with previous data where it was reported that \\(100\\%\\) of the people had a ‘Free union’ civil status. The second step was to work with the missing values in the continuous features and missing values in the categorical demographic features. Records containing missing values were eliminated as proposed in the data qulaity plan described in Table ??. The same apply to the categorical demographic features. After applying the process to delete records with missing values in continuous and categorical demographics features the dataset reducts its dimentionality from 338 to 326, which represents a reduction of 0.036% of the original data. In the third step of this stage the atypical values are identified to exclude them from the dataset that will serve as a source of the training of the model. The process excludes records that exceed three standard deviations in the variable SQ4 (‘time the person spent asleep’). This variable is of high impact on the quality of sleep and is not considered within the factors of sleep hygiene. Another indicator of a possible sleep disorder is the latency, latency is the time between a person go to bed and he/she fall asleep. The records containing outliers in this feature, also were eliminated. After delete records with outliers n continuous variables the dataset reducts its dimentionality from 338 to 306, which represents a reduction of 0.095% of the original data. The Fig. 4.2, shows the histograms and boxplots after eliminated records with outliers in SQ2 and SQ4, boxplots in these two variables make it clear that do not outliers were found for these features. DD1 has no outliers too, even though maintaining the original records. Figure 4.2: Histograms and boxplots of the continuous features after delete outliers 4.5 Imputation of missing values in SH and SQ features The process of imputation was performed using mice and VIM package (van Buuren and Groothuis-Oudshoorn 2011,Kowarik and Templ (2016)). the process begins with the analysis of missing values in the variables involved indirectly or directly in the generation of the model. The table ?? shows that the dataset has few missing values (Not all columns in the table are included for lack of space, however, all columns that were omitted do not have missing values). It has \\(297\\) complete records, a record with a missing value in the column SQ5a, one more with a missing value in the column SQ5c, an so on. The dataset contains eight records with a total of nine missing values in eight variables. A summary of the missing values its presented in the table ?? The figure 4.3 shows in the left side, an histogram of the features with missing data depicting the influence of missing values in the dataset. The right side shows the pattern of missing values in the dataset, it concentrates all complete cases in the botton of the graph, which reach a 97.06% of the dataset. The remaining of the figure shows the features with missing data, placing in the right side the corresponding percentages per variable. Figure 4.3: Pattern of missing values The mice function was executed to impute data in the records containing missing values, the process was performed in a temporal dataset comformed only for those features with missing data. The mice function perform data imputation using polytomous regression imputataion for unordered categorical data with more of two leves, which is the case. The multinomial logistic regression was applied with 50 iterations and five datasets to obtain a table of results that allow to choose the best option to do the imputation. The DS4 is the dataset most consistent with the proposals in the other datasets, it matches with at least one dataset of the remaining four, in seven of the rows. The DS4 was chosen to impute data in these variables. The table ??, shows that no missing value are in the dataset after the imputation, now the new dataset of variables with data imputation will be merged with the others features of the original dataset in a new dataset to be saved and used in advanced to train the model. 4.6 Final results The following tables show the report of quality in the dataset after apply deletion of missing values, exclusion of records containing outliers and imputation of missing values in variables that are closely related with the training of the model. With exception of high percentages in mode of the SH8 and SH9, all other features present a good behavior in the dataset. The issue of SH8 and SH9 will be attended in a future stage of the work, the process of feature selection will take care of this. The last process to be carried out in this stage is the calculation of SHI and PSQI scores through the scales provided by the respective questionnaires. The final dataset to be used in the process of feature selection is a 306 x 62 dataset containing 10 continuous features, 51 categorical features and one ID feature. To more detail of this dataset, see please the tables at the end of the previous section. References "],
["methods.html", "Chapter 5 Methods", " Chapter 5 Methods We describe our methods in this chapter. "],
["methods-1.html", "Chapter 6 Methods", " Chapter 6 Methods We describe our methods in this chapter. "],
["applications.html", "Chapter 7 Applications 7.1 Example one 7.2 Example two", " Chapter 7 Applications Some significant applications are demonstrated in this chapter. 7.1 Example one 7.2 Example two "],
["references.html", "References", " References "],
["final-words.html", "Chapter 8 Final Words", " Chapter 8 Final Words We have finished a nice book. "]
]
